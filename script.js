async function runScan(){let t=document.getElementById("targetUrl").value.trim(),o=document.getElementById("output");o.innerHTML="[*] hittin...";if(!t.match(/^https?:\/\/.+/))return o.innerHTML="[!] url borked";let r="";try{let e=`http://localhost:3000/proxy?url=${encodeURIComponent(t)}`,s=await fetch(e),a=await s.json();r+="==hdrs==\n";for(let[key,val]of Object.entries(a.headers))r+=`${key}:${val}\n`;let n=a.body;r+="\n==raw==\n";let l=new DOMParser(),c=l.parseFromString(n,"text/html"),d=c.querySelectorAll("a[href]"),u=c.querySelectorAll("form[action]");r+="\n--paths--\n",d.forEach(e=>{let s=e.getAttribute("href");s&&s.match(/^\//)&&(r+=`link:${t}${s}\n`)}),u.forEach(e=>{let s=e.getAttribute("action");s&&s.match(/^\//)&&(r+=`form:${t}${s}\n`)});let p=c.querySelectorAll("script");r+="\n--js--\n",p.forEach(e=>e.innerHTML&&(r+=e.innerHTML.slice(0,200)+"...\n"));r+="\n--leaks--\n";let f=[{n:"api",r:/api[_-]?key[^=]*=[^&\s;]+/gi},{n:"jwt",r:/eyJ[A-Za-z0-9-_]+\.eyJ[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+/gi},{n:"aws",r:/AKIA[0-9A-Z]{16}/gi},{n:"tkn",r:/token[^=]*=[^&\s;]+/gi},{n:"pwd",r:/password[^=]*=[^&\s;]+/gi}];f.forEach(e=>{let s=n.match(e.r);s&&(r+=`${e.n}:\n${s.join("\n")}\n`)}),o.innerHTML=r}catch(e){o.innerHTML=`[!] crash:${e.message}. proxy up?`}}async function runFuzzer(){let t=document.getElementById("targetUrl").value.trim(),o=document.getElementById("output");o.innerHTML="[*] fuzzin...";if(!t.match(/^https?:\/\/.+/))return o.innerHTML="[!] url borked";let r="==fuzz==\n",h=["/admin","/api","/config","/login","/dashboard","/wp-admin","/.env","/backup","/test","/dev"];for(let e of h){let s=`${t}${e}`;try{let a=`http://localhost:3000/proxy?url=${encodeURIComponent(s)}`,n=await fetch(a),l=n.status;r+=`${s}:${l} ${n.statusText}\n`}catch(a){r+=`${s}:fail(${a.message})\n`}}o.innerHTML=r}
